# fields_config.py
"""
Конфигурация полей для Excel экспорта
Все настройки полей в одном месте
"""


def get_fields_config():
    """
    Полная конфигурация всех возможных полей с их свойствами

    Структура:
    - key: внутренний ключ поля (как хранится в данных)
    - title: отображаемое название в Excel
    - width: ширина колонки
    - export: True/False - экспортировать ли это поле
    - order: порядок в Excel (чем меньше число, тем левее колонка)
    """

    fields_config = {
        # ========================================
        # ОСНОВНЫЕ ПОЛЯ СОБЫТИЯ (экспортируются)
        # ========================================

        "event_number": {
            "title": "Номер заходу",
            "width": 15,
            "export": True,
            "order": 1
        },
        "event_name": {
            "title": "Захід",
            "width": 28,
            "export": True,
            "order": 2
        },

        # ========================================
        # ОСНОВНЫЕ ДАННЫЕ (экспортируются)
        # ========================================

        "дата": {
            "title": "Дата",
            "width": 25,
            "export": True,
            "order": 3
        },
        "адреса": {
            "title": "Адреса",
            "width": 40,
            "export": True,
            "order": 4
        },
        "дк": {
            "title": "ДК",
            "width": 15,
            "export": True,
            "order": 5
        },
        "товар": {
            "title": "Товар",
            "width": 29,
            "export": True,
            "order": 6
        },
        "кількість": {
            "title": "Кількість",
            "width": 12,
            "export": True,
            "order": 7
        },
        "ціна за одиницю": {
            "title": "Ціна за одиницю",
            "width": 18,
            "export": True,
            "order": 8
        },
        "разом": {
            "title": "Разом",
            "width": 18,
            "export": True,
            "order": 9
        },

        # ========================================
        # КОНТАКТНЫЕ ДАННЫЕ (экспортируются)
        # ========================================

        "телефон": {
            "title": "Телефон",
            "width": 15,
            "export": True,
            "order": 10
        },
        "email": {
            "title": "Email",
            "width": 25,
            "export": True,
            "order": 11
        },

        # ========================================
        # ДОПОЛНИТЕЛЬНЫЕ ПОЛЯ (при необходимости)
        # ========================================

        "примечание": {
            "title": "Примечание",
            "width": 30,
            "export": True,
            "order": 15
        },
        "категория": {
            "title": "Категория",
            "width": 20,
            "export": True,
            "order": 16
        },

        # ========================================
        # СЛУЖЕБНЫЕ ПОЛЯ (НЕ экспортируются)
        # ========================================

        "id": {
            "title": "ID",
            "width": 10,
            "export": False,
            "order": 999
        },
        "номер": {
            "title": "Номер",
            "width": 15,
            "export": False,  # Дублирует event_number
            "order": 999
        },
        "created_at": {
            "title": "Дата создания",
            "width": 20,
            "export": False,
            "order": 999
        },
        "updated_at": {
            "title": "Дата обновления",
            "width": 20,
            "export": False,
            "order": 999
        },

    }

    return fields_config


def get_numeric_fields():
    """
    Возвращает список полей, которые должны быть обработаны как числовые
    """
    numeric_fields = [
        "кількість",
        "ціна за одиницю",
        "разом",
    ]
    return [field.lower() for field in numeric_fields]